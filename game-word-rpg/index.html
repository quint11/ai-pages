<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>文字冒险 RPG - 完整闭环</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: radial-gradient(circle at center, #0f1a3d, #1a2a6c, #0c1026);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1500px;
            width: 100%;
            height: 100%;
            background: rgba(10, 15, 30, 0.85);
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7);
            overflow: hidden;
            border: 2px solid #3a506b;
            position: relative;
        }
        
        /* 装饰效果 */
        .decoration {
            position: absolute;
            opacity: 0.1;
        }
        
        .decoration.sword {
            top: 50px;
            right: 30px;
            font-size: 5rem;
            transform: rotate(30deg);
        }
        
        .decoration.shield {
            bottom: 80px;
            left: 30px;
            font-size: 4rem;
            transform: rotate(-15deg);
        }
        
        header {
            background: linear-gradient(to right, #0c2d6b, #1a3a8f);
            padding: 25px;
            text-align: center;
            border-bottom: 4px solid #d4af37;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100"><path d="M0 0 L100 0 L100 100 L0 100 Z" fill="none" stroke="%23d4af37" stroke-width="1" stroke-dasharray="5,5"/></svg>');
            opacity: 0.3;
        }
        
        h1 {
            font-size: 3.2rem;
            margin-bottom: 10px;
            color: #ffd700;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            letter-spacing: 2px;
            position: relative;
            z-index: 2;
            font-weight: 800;
        }
        
        .subtitle {
            color: #a8c6ff;
            font-size: 1.3rem;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
            position: relative;
            z-index: 2;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        
        .screen {
            display: none;
            padding: 25px;
            min-height: 500px;
        }
        
        .screen.active {
            display: block;
        }
        
        .game-container {
            display: flex;
            gap: 25px;
        }
        
        .player-section {
            flex: 1;
            background: rgba(20, 30, 50, 0.7);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
            border: 1px solid #3a506b;
            position: relative;
            min-width: 300px;
        }
        
        .game-section {
            flex: 2;
            background: rgba(20, 30, 50, 0.7);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
            border: 1px solid #3a506b;
            min-width: 500px;
        }
        
        .section-title {
            font-size: 1.7rem;
            color: #ffd700;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #3a506b;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: #d4af37;
        }
        
        .status-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .status-bar {
            display: flex;
            justify-content: space-between;
            background: linear-gradient(to right, #1c2e4a, #2c3e50);
            padding: 14px;
            border-radius: 10px;
            margin-bottom: 5px;
            border: 1px solid #3a506b;
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
            transition: transform 0.2s;
        }
        
        .status-bar:hover {
            transform: translateY(-3px);
        }
        
        .status-label {
            font-weight: bold;
            color: #ffd700;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .progress-bar {
            height: 50px;
            background: rgba(0,0,0,0.3);
            border-radius: 3px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 3px;
        }
        
        .health-fill {
            background: linear-gradient(to right, #ff416c, #ff4b2b);
        }
        
        .mana-fill {
            background: linear-gradient(to right, #2193b0, #6dd5ed);
        }
        
        .exp-fill {
            background: linear-gradient(to right, #00b09b, #96c93d);
        }
        
        .inventory {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }
        
        .item {
            background: linear-gradient(to bottom right, #2c3e50, #1c2e4a);
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #3a506b;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
            transition: transform 0.2s;
            cursor: pointer;
            position: relative;
        }
        
        .item:hover {
            transform: translateY(-3px);
            background: linear-gradient(to bottom right, #3a506b, #2c3e50);
        }
        
        .item-icon {
            font-size: 2rem;
            margin-bottom: 8px;
            color: #ffd700;
        }
        
        .item-count {
            position: absolute;
            top: 5px;
            right: 8px;
            background: #d4af37;
            color: #000;
            font-weight: bold;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }
        
        .game-log {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 20px;
            height: 320px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            line-height: 1.7;
            margin-bottom: 15px;
            border: 1px solid #3a506b;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="none" stroke="%233a506b" stroke-width="0.5"/></svg>');
        }
        
        .game-log p {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 6px;
            background: rgba(0,0,0,0.2);
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .location-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 10px;
        }
        
        .combat-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }
        
        button {
            background: linear-gradient(to bottom, #d4af37, #b8860b);
            color: #1a1a2e;
            border: none;
            padding: 14px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            text-shadow: 0 1px 0 rgba(255, 255, 255, 0.3);
            font-size: 1.05rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            border: 1px solid #ffd700;
        }
        
        button:hover {
            background: linear-gradient(to bottom, #ffd700, #daa520);
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(0, 0, 0, 0.3);
        }
        
        button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        button:disabled {
            background: #444;
            color: #777;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            border: 1px solid #555;
        }
        
        .save-load {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }
        
        .save-load button {
            flex: 1;
        }
        
        .player-info {
            text-align: center;
            position: relative;
            padding: 15px 0;
        }
        
        .player-image {
            font-size: 6rem;
            margin: 10px 0;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.5));
            transition: transform 0.3s;
        }
        
        .player-image:hover {
            transform: scale(1.1) rotate(5deg);
        }
        
        .player-name {
            font-size: 1.4rem;
            color: #ffd700;
            margin-top: 5px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        
        .player-class {
            color: #a8c6ff;
            font-size: 1.1rem;
            margin-top: 3px;
        }
        
        .enemy-info {
            background: linear-gradient(to right, #4b0000, #8b0000);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid #ff5555;
            box-shadow: 0 5px 15px rgba(139, 0, 0, 0.4);
            position: relative;
        }
        
        .enemy-image {
            font-size: 5rem;
            margin-bottom: 15px;
            text-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.5));
        }
        
        .enemy-stats {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 15px;
        }
        
        .enemy-stat {
            background: rgba(0,0,0,0.3);
            padding: 10px 20px;
            border-radius: 10px;
            min-width: 100px;
        }
        
        .event {
            color: #ffcc00;
            border-left: 3px solid #ffcc00;
        }
        
        .damage {
            color: #ff5555;
            background: rgba(139, 0, 0, 0.2);
        }
        
        .heal {
            color: #55ff55;
            background: rgba(0, 100, 0, 0.2);
        }
        
        .gold {
            color: #ffd700;
            background: rgba(184, 134, 11, 0.2);
        }
        
        .quest {
            color: #55ffff;
            border-left: 3px solid #55ffff;
        }
        
        .victory {
            color: #96c93d;
            border-left: 3px solid #96c93d;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background: linear-gradient(to right, #0c2d6b, #1a3a8f);
            color: #a8c6ff;
            font-size: 1rem;
            border-top: 1px solid #3a506b;
        }
        
        .xp-bar {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 5px;
        }
        
        .xp-text {
            font-size: 0.9rem;
            color: #aaa;
        }
        
        .level-badge {
            background: #d4af37;
            color: #000;
            font-weight: bold;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.9rem;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: linear-gradient(to right, #0c2d6b, #1a3a8f);
            color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transform: translateX(200%);
            transition: transform 0.3s ease;
            z-index: 1000;
            border-left: 5px solid #d4af37;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .start-screen, .end-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            min-height: 500px;
            padding: 40px;
        }
        
        .start-title {
            font-size: 4.0rem;
            color: #ffd700;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
            margin-bottom: 10px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }
        
        .start-subtitle {
            font-size: 1.8rem;
            color: #a8c6ff;
            max-width: 1200px;
            margin-bottom: 40px;
            line-height: 1.6;
        }
        
        .start-options {
            display: flex;
            gap: 20px;
            margin-top: 30px;
        }
        
        .start-btn {
            padding: 18px 40px;
            font-size: 1.5rem;
            border-radius: 15px;
        }
        
        .character-select {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 30px;
            margin: 40px 0;
        }
        
        .character {
            background: rgba(30, 40, 70, 0.7);
            border-radius: 15px;
            padding: 25px;
            cursor: pointer;
            transition: all 0.3s;
            border: 2px solid transparent;
        }
        
        .character:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 25px rgba(0,0,0,0.3);
            border-color: #d4af37;
            background: rgba(40, 50, 90, 0.8);
        }
        
        .character.selected {
            border-color: #ffd700;
            background: rgba(50, 60, 100, 0.9);
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(212, 175, 55, 0.5);
        }
        
        .character-icon {
            font-size: 5rem;
            margin-bottom: 20px;
        }
        
        .character-name {
            font-size: 1.8rem;
            color: #ffd700;
            margin-bottom: 10px;
        }
        
        .character-desc {
            font-size: 1.1rem;
            color: #a8c6ff;
            line-height: 1.6;
        }
        
        .victory-screen {
            text-align: center;
        }
        
        .victory-title {
            font-size: 5rem;
            color: #ffd700;
            margin-bottom: 30px;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
        }
        
        .victory-image {
            font-size: 10rem;
            margin: 30px 0;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
            100% { transform: translateY(0px); }
        }
        
        .victory-text {
            font-size: 1.8rem;
            max-width: 800px;
            margin: 0 auto 40px;
            line-height: 1.7;
            color: #a8c6ff;
        }
        
        .end-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
            max-width: 800px;
        }
        
        .end-stat {
            background: rgba(30, 40, 70, 0.7);
            border-radius: 10px;
            padding: 20px;
        }
        
        .end-stat-value {
            font-size: 2.5rem;
            color: #ffd700;
            margin: 10px 0;
        }
        
        .end-stat-label {
            font-size: 1.2rem;
            color: #a8c6ff;
        }
        
        @media (max-width: 900px) {
            .game-container {
                flex-direction: column;
            }
            
            .player-section, .game-section {
                min-width: auto;
            }
            
            .inventory {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .character-select {
                grid-template-columns: 1fr;
            }
            
            .end-stats {
                grid-template-columns: 1fr;
            }
        }
        
        @media (max-width: 600px) {
            .action-buttons, .location-buttons, .combat-buttons {
                grid-template-columns: 1fr;
            }
            
            .player-image {
                font-size: 4.5rem;
            }
            
            .enemy-image {
                font-size: 3.5rem;
            }
            
            .enemy-stats {
                flex-direction: column;
                gap: 10px;
            }
            
            .start-options {
                flex-direction: column;
                gap: 15px;
            }
            
            .start-title {
                font-size: 3rem;
            }
            
            .start-subtitle {
                font-size: 1.3rem;
            }
            
            .victory-title {
                font-size: 3rem;
            }
            
            .victory-image {
                font-size: 6rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="decoration sword">⚔️</div>
        <div class="decoration shield">🛡️</div>
        
        <header>
            <div class="subtitle">探索神秘大陆，击败强大敌人，成为传奇英雄！</div>
        </header>
        
        <!-- 开始界面 -->
        <div id="startScreen" class="screen active">
            <div class="start-screen">
                <div class="start-title">冒险者传说</div>
                <div class="start-subtitle">在这片被黑暗笼罩的大陆上，一条古老的巨龙苏醒了，它的力量威胁着整个王国。作为被选中的冒险者，你必须踏上征途，收集强大的神器，最终在巨龙山脉与恶龙决一死战！</div>
                
                <div class="character-select">
                    <div class="character" data-class="warrior">
                        <div class="character-icon">⚔️</div>
                        <div class="character-name">战士</div>
                        <div class="character-desc">强大的近战专家，拥有高生命值和防御力<br>特殊能力：雷霆一击 - 造成双倍伤害</div>
                    </div>
                    
                    <div class="character" data-class="mage">
                        <div class="character-icon">🧙‍♂️</div>
                        <div class="character-name">法师</div>
                        <div class="character-desc">元素魔法大师，拥有强大的法术攻击<br>特殊能力：火焰风暴 - 对敌人造成持续伤害</div>
                    </div>
                    
                    <div class="character" data-class="ranger">
                        <div class="character-icon">🏹</div>
                        <div class="character-name">游侠</div>
                        <div class="character-desc">敏捷的远程专家，擅长闪避和致命一击<br>特殊能力：精准射击 - 必定命中并造成额外伤害</div>
                    </div>
                </div>
                
                <div class="start-options">
                    <button id="newGameBtn" class="start-btn"><i class="fas fa-play"></i> 开始新游戏</button>
                    <button id="continueBtn" class="start-btn"><i class="fas fa-folder-open"></i> 继续游戏</button>
                </div>
            </div>
        </div>
        
        <!-- 游戏主界面 -->
        <div id="gameScreen" class="screen">
            <div class="game-container">
                <div class="player-section">
                    <h2 class="section-title"><i class="fas fa-user"></i> 冒险者信息</h2>
                    
                    <div class="player-info">
                        <div class="player-image" id="playerIcon"></div>
                        <div class="player-name" id="playerName"></div>
                        <div class="player-class" id="playerClass"></div>
                    </div>
                    
                    <div class="status-container">
                        <div class="status-bar">
                            <span class="status-label"><i class="fas fa-heart"></i> 生命值:</span>
                            <span id="health">100/100</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill health-fill" id="health-bar" style="width: 100%"></div>
                        </div>
                        
                        <div class="status-bar">
                            <span class="status-label"><i class="fas fa-fire"></i> 魔法值:</span>
                            <span id="mana">50/50</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill mana-fill" id="mana-bar" style="width: 100%"></div>
                        </div>
                        <div class="status-bar">
                            <span class="status-label"><i class="fas fa-star"></i> 经验值:</span>
                            <div class="xp-bar">
                                <span id="exp">0/100</span>
                                <span class="level-badge">Lv.<span id="level">1</span></span>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill exp-fill" id="exp-bar" style="width: 0%"></div>
                        </div>
                        

                        <div class="status-bar">
                            <span class="status-label"><i class="fas fa-shield-alt"></i> 攻击力:</span>
                            <span id="attack">15</span>
                        </div>
                       
                        <div class="status-bar">
                            <span class="status-label"><i class="fas fa-shield-virus"></i> 防御力:</span>
                            <span id="defense">8</span>
                        </div>
                        
                        <div class="status-bar">
                            <span class="status-label"><i class="fas fa-coins"></i> 金币:</span>
                            <span id="gold">50</span>
                        </div>
                        
                        
            
                    </div>
                    
                    <h3 class="section-title"><i class="fas fa-backpack"></i> 背包</h3>
                    <div class="inventory" id="inventory">
                        <div class="item" id="health-potion">
                            <div class="item-icon">❤️</div>
                            <div>生命药水</div>
                            <div class="item-count" id="potion-count">1</div>
                        </div>
                        <div class="item" id="key-item">
                            <div class="item-icon">🔑</div>
                            <div>神秘钥匙</div>
                            <div class="item-count" id="key-count">0</div>
                        </div>
                        <div class="item" id="gem-item">
                            <div class="item-icon">💎</div>
                            <div>龙之宝石</div>
                            <div class="item-count" id="gem-count">0</div>
                        </div>
                    </div>
                    
                    <div class="save-load">
                        <button id="saveBtn"><i class="fas fa-save"></i> 保存进度</button>
                        <button id="menuBtn"><i class="fas fa-home"></i> 返回菜单</button>
                    </div>
                </div>
                
                <div class="game-section">
                    
                    <div id="combatSection">
                        <div class="enemy-info">
                            <div class="enemy-image" id="enemyImage">🐺</div>
                            <div style="font-size: 1.3rem; margin-bottom: 10px;">敌人: <span id="enemyName">野狼</span></div>
                            
                            <div class="enemy-stats">
                                <div class="enemy-stat">
                                    <div>生命值</div>
                                    <div id="enemyHealth">40/40</div>
                                    <div class="progress-bar">
                                        <div class="progress-fill health-fill" id="enemy-health-bar" style="width: 100%"></div>
                                    </div>
                                </div>
                                <div class="enemy-stat">
                                    <div>攻击力</div>
                                    <div id="enemyAttack">10</div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="combat-buttons">
                            <button id="attackBtn"><i class="fas fa-fist-raised"></i> 攻击</button>
                            <button id="skillBtn"><i class="fas fa-magic"></i> 技能</button>
                            <button id="potionBtn"><i class="fas fa-wine-bottle"></i> 药水</button>
                            <button id="fleeBtn"><i class="fas fa-running"></i> 逃跑</button>
                        </div>
                    </div>

                    <div id="noCombatSection" style="text-align: center; padding: 40px 20px;">
                        <div style="font-size: 4rem; margin-bottom: 20px;">⚔️</div>
                        <p>当前没有战斗</p>
                        <p class="event" style="margin-top: 10px;">探索区域可能会遇到敌人！</p>
                    </div>
                    
                    <h3 class="section-title"><i class="fas fa-map-marker-alt"></i> 当前位置: <span id="location">宁静村庄</span></h3>
                    
                    <div class="action-buttons">
                        <button id="exploreBtn"><i class="fas fa-binoculars"></i> 探索当前区域</button>
                        <button id="restBtn"><i class="fas fa-bed"></i> 休息恢复</button>
                        <button id="shopBtn"><i class="fas fa-shopping-cart"></i> 访问商店</button>
                        <button id="upgradeBtn"><i class="fas fa-tools"></i> 升级装备</button>
                    </div>
                    
                    <div class="location-buttons">
                        <button id="forestBtn"><i class="fas fa-tree"></i> 幽暗森林</button>
                        <button id="caveBtn"><i class="fas fa-mountain"></i> 神秘洞穴</button>
                        <button id="mountainBtn"><i class="fas fa-dragon"></i> 巨龙山脉</button>
                    </div>
                    
                    <h2 class="section-title"><i class="fas fa-scroll"></i> 冒险日志</h2>
                    <div class="game-log" id="gameLog">
                        <p>欢迎来到冒险者传说！你是一名初出茅庐的冒险者。</p>
                        <p>你出现在宁静村庄的广场上。村民们看起来有些不安，似乎有事情发生。</p>
                        <p class="event">村长告诉你：最近村庄附近出现了怪物，请帮帮我们！</p>
                        <p class="quest">任务：击败幽暗森林的怪物（0/3）</p>
                    </div>
                    
                </div>
            </div>
        </div>
        
        <!-- 游戏结束界面 -->
        <div id="endScreen" class="screen">
            <div class="end-screen">
                <div class="victory-screen">
                    <div class="victory-title">胜利！</div>
                    <div class="victory-image">🏆</div>
                    
                    <div class="victory-text">
                        经过漫长而艰苦的战斗，你终于击败了可怕的远古红龙！它的力量消散在空气中，王国终于从阴影中解放出来。人民将永远铭记你的名字，吟游诗人将传唱你的传奇故事！
                    </div>
                    
                    <div class="end-stats">
                        <div class="end-stat">
                            <div class="end-stat-value" id="finalLevel">1</div>
                            <div class="end-stat-label">最终等级</div>
                        </div>
                        <div class="end-stat">
                            <div class="end-stat-value" id="finalGold">0</div>
                            <div class="end-stat-label">获得金币</div>
                        </div>
                        <div class="end-stat">
                            <div class="end-stat-value" id="finalMonsters">0</div>
                            <div class="end-stat-label">击败怪物</div>
                        </div>
                    </div>
                    
                    <button id="restartBtn" class="start-btn"><i class="fas fa-redo"></i> 重新开始</button>
                </div>
            </div>
        </div>
        
        <footer>
            <p>冒险者传说 RPG | 完整闭环游戏 | 使用HTML5, CSS3和JavaScript构建</p>
        </footer>
    </div>

    <div class="notification" id="notification">通知消息</div>

    <script>
        // 游戏状态
        const gameState = {
            characterClass: "warrior",
            health: 100,
            maxHealth: 100,
            mana: 50,
            maxMana: 50,
            attack: 15,
            defense: 8,
            gold: 50,
            exp: 0,
            level: 1,
            potions: 1,
            manaPotions: 0,
            attackPotions: 0,
            defensePotions: 0,
            keys: 0,
            gems: 0,
            location: 'village',
            inCombat: false,
            enemy: null,
            nextLevelExp: 100,
            forestKills: 0,
            caveExplored: false,
            dragonDefeated: false,
            monstersDefeated: 0,
            questStep: 1,
            gameCompleted: false
        };
        
        // 敌人数据
        const enemies = {
            forest: [
                { name: "野狼", health: 80, maxHealth: 80, attack: 10, minGold: 5, maxGold: 15, exp: 30, emoji: "🐺" },
                { name: "巨蜘蛛", health: 60, maxHealth: 60, attack: 12, minGold: 8, maxGold: 18, exp: 40, emoji: "🕷️" },
                { name: "森林巨熊", health: 150, maxHealth: 150, attack: 18, minGold: 20, maxGold: 35, exp: 70, emoji: "🐻" }
            ],
            cave: [
                { name: "洞穴蝙蝠", health: 65, maxHealth: 65, attack: 8, minGold: 3, maxGold: 10, exp: 20, emoji: "🦇" },
                { name: "剧毒蝎子", health: 85, maxHealth: 85, attack: 14, minGold: 10, maxGold: 20, exp: 45, emoji: "🦂" },
                { name: "石像鬼", health: 180, maxHealth: 180, attack: 22, minGold: 30, maxGold: 50, exp: 100, emoji: "🗿" }
            ],
            mountain: [
                { name: "山鹰", health: 125, maxHealth: 125, attack: 16, minGold: 15, maxGold: 25, exp: 50, emoji: "🦅" },
                { name: "雪怪", health: 200, maxHealth: 200, attack: 26, minGold: 40, maxGold: 70, exp: 150, emoji: "❄️" },
                { name: "红龙", health: 500, maxHealth: 500, attack: 45, minGold: 200, maxGold: 300, exp: 500, emoji: "🐉" }
            ]
        };
        
        // 位置名称映射
        const locationNames = {
            village: "宁静村庄",
            forest: "幽暗森林",
            cave: "神秘洞穴",
            mountain: "巨龙山脉"
        };
        
        // 角色数据
        const classes = {
            warrior: {
                name: "战士",
                icon: "⚔️",
                attack: 18,
                defense: 12,
                health: 120,
                mana: 30,
                skill: "雷霆一击"
            },
            mage: {
                name: "法师",
                icon: "🧙‍♂️",
                attack: 22,
                defense: 6,
                health: 90,
                mana: 70,
                skill: "火焰风暴"
            },
            ranger: {
                name: "游侠",
                icon: "🏹",
                attack: 20,
                defense: 8,
                health: 100,
                mana: 50,
                skill: "精准射击"
            }
        };
        
        // DOM 元素
        const startScreen = document.getElementById('startScreen');
        const gameScreen = document.getElementById('gameScreen');
        const endScreen = document.getElementById('endScreen');
        const gameLog = document.getElementById('gameLog');
        const healthEl = document.getElementById('health');
        const manaEl = document.getElementById('mana');
        const attackEl = document.getElementById('attack');
        const defenseEl = document.getElementById('defense');
        const goldEl = document.getElementById('gold');
        const expEl = document.getElementById('exp');
        const levelEl = document.getElementById('level');
        const potionCountEl = document.getElementById('potion-count');
        const keyCountEl = document.getElementById('key-count');
        const gemCountEl = document.getElementById('gem-count');
        const locationEl = document.getElementById('location');
        const combatSection = document.getElementById('combatSection');
        const enemyNameEl = document.getElementById('enemyName');
        const enemyHealthEl = document.getElementById('enemyHealth');
        const enemyAttackEl = document.getElementById('enemyAttack');
        const enemyImageEl = document.getElementById('enemyImage');
        const healthBar = document.getElementById('health-bar');
        const manaBar = document.getElementById('mana-bar');
        const expBar = document.getElementById('exp-bar');
        const enemyHealthBar = document.getElementById('enemy-health-bar');
        const notification = document.getElementById('notification');
        const playerIcon = document.getElementById('playerIcon');
        const playerName = document.getElementById('playerName');
        const playerClass = document.getElementById('playerClass');
        const finalLevel = document.getElementById('finalLevel');
        const finalGold = document.getElementById('finalGold');
        const finalMonsters = document.getElementById('finalMonsters');
        
        // 更新战斗UI
        function updateCombatUI() {
            if (gameState.inCombat && gameState.enemy) {
                combatSection.style.display = 'block';
                noCombatSection.style.display = 'none';
                updateEnemyInfo();
            } else {
                combatSection.style.display = 'none';
                noCombatSection.style.display = 'block';
            }
        }
        
        // 禁用战斗按钮
        function disableCombatButtons() {
            gameState.actionInProgress = true;
            attackBtn.disabled = true;
            skillBtn.disabled = true;
            potionBtn.disabled = true;
            fleeBtn.disabled = true;
        }
        
        // 启用战斗按钮
        function enableCombatButtons() {
            gameState.actionInProgress = false;
            attackBtn.disabled = false;
            skillBtn.disabled = false;
            potionBtn.disabled = false;
            fleeBtn.disabled = false;
            
            // 更新技能冷却状态
            updateSkillCooldown();
        }
        
        // 更新技能冷却
        function updateSkillCooldown() {
            if (gameState.skillCooldown > 0) {
                skillBtn.disabled = true;
                const cooldownElement = document.createElement('div');
                cooldownElement.className = 'skill-cooldown';
                cooldownElement.textContent = gameState.skillCooldown;
                
                // 移除现有的冷却显示
                const existingCooldown = document.querySelector('.skill-cooldown');
                if (existingCooldown) existingCooldown.remove();
                
                skillBtn.appendChild(cooldownElement);
            } else {
                skillBtn.disabled = false;
                const existingCooldown = document.querySelector('.skill-cooldown');
                if (existingCooldown) existingCooldown.remove();
            }
        }
        
        // 减少技能冷却
        function reduceSkillCooldown() {
            if (gameState.skillCooldown > 0) {
                gameState.skillCooldown--;
                updateSkillCooldown();
            }
        }

        // 显示通知
        function showNotification(message) {
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // 开始新游戏
        function startNewGame() {
            // 重置游戏状态
            Object.assign(gameState, {
                health: 100,
                maxHealth: 100,
                mana: 50,
                maxMana: 50,
                attack: 15,
                defense: 8,
                gold: 50,
                exp: 0,
                level: 1,
                potions: 1,
                manaPotions: 0,
                attackPotions: 0,
                defensePotions: 0,
                keys: 0,
                gems: 0,
                location: 'village',
                inCombat: false,
                enemy: null,
                nextLevelExp: 100,
                forestKills: 0,
                caveExplored: false,
                dragonDefeated: false,
                monstersDefeated: 0,
                questStep: 1,
                gameCompleted: false
            });
            
            // 应用角色职业加成
            const charClass = classes[gameState.characterClass];
            gameState.maxHealth = charClass.health;
            gameState.health = charClass.health;
            gameState.maxMana = charClass.mana;
            gameState.mana = charClass.mana;
            gameState.attack = charClass.attack;
            gameState.defense = charClass.defense;
            
            // 更新角色显示
            playerIcon.textContent = charClass.icon;
            playerName.textContent = charClass.name;
            playerClass.textContent = charClass.name;
            
            // 清空日志
            gameLog.innerHTML = `
                <p>欢迎来到冒险者传说！你是一名${charClass.name}。</p>
                <p>你出现在宁静村庄的广场上。村民们看起来有些不安，似乎有事情发生。</p>
                <p class="event">村长告诉你：最近村庄附近出现了怪物，请帮帮我们！</p>
                <p class="quest">任务：击败幽暗森林的怪物（0/3）</p>
            `;
            
            // 更新UI
            updateStats();
            updateInventory();
            locationEl.textContent = locationNames[gameState.location];
            updateCombatUI();
            
            // 切换到游戏界面
            startScreen.classList.remove('active');
            gameScreen.classList.add('active');
        }
        
        // 更新状态显示
        function updateStats() {
            healthEl.textContent = `${gameState.health}/${gameState.maxHealth}`;
            manaEl.textContent = `${gameState.mana}/${gameState.maxMana}`;
            attackEl.textContent = gameState.attack;
            defenseEl.textContent = gameState.defense;
            goldEl.textContent = gameState.gold;
            expEl.textContent = `${gameState.exp}/${gameState.nextLevelExp}`;
            levelEl.textContent = gameState.level;
            
            // 更新进度条
            const healthPercent = (gameState.health / gameState.maxHealth) * 100;
            healthBar.style.width = `${healthPercent}%`;
            
            const manaPercent = (gameState.mana / gameState.maxMana) * 100;
            manaBar.style.width = `${manaPercent}%`;
            
            const expPercent = (gameState.exp / gameState.nextLevelExp) * 100;
            expBar.style.width = `${expPercent}%`;
        }
        
        // 更新背包
        function updateInventory() {
            potionCountEl.textContent = gameState.potions;
            keyCountEl.textContent = gameState.keys;
            gemCountEl.textContent = gameState.gems;
        }
        
        // 添加日志
        function addToLog(message, className = "") {
            const p = document.createElement('p');
            if (className) p.className = className;
            p.textContent = message;
            gameLog.appendChild(p);
            gameLog.scrollTop = gameLog.scrollHeight;
        }
        
        // 探索当前区域
        function explore() {
            if (gameState.inCombat) {
                addToLog("你正在战斗中，无法探索！", "event");
                return;
            }
            
            // 30%的几率没有遇到敌人
            if (Math.random() < 0.3) {
                // 随机事件
                const events = [
                    "你在该区域探索了一番，发现了一些有用的草药。",
                    "你发现了一个宝箱，里面有一些金币！",
                    "你遇到了一位旅行商人，他卖给你一些药水。",
                    "你发现了一个废弃的营地，找到了一些补给。",
                    "你发现了一个隐藏的洞穴入口。"
                ];
                
                const event = events[Math.floor(Math.random() * events.length)];
                addToLog(event, "event");
                
                // 奖励
                if (Math.random() < 0.4) {
                    const goldGain = Math.floor(Math.random() * 10) + 5;
                    gameState.gold += goldGain;
                    addToLog(`获得了${goldGain}金币！`, "gold");
                    showNotification(`获得 ${goldGain} 金币！`);
                }
                
                if (Math.random() < 0.3) {
                    gameState.potions++;
                    addToLog("获得了1瓶生命药水！", "heal");
                    showNotification("获得生命药水 x1");
                    updateInventory();
                }
                
                // 洞穴探索特殊事件
                if (gameState.location === 'cave' && !gameState.caveExplored && Math.random() < 0.5) {
                    gameState.keys++;
                    addToLog("在洞穴深处，你找到了神秘钥匙！", "event");
                    showNotification("获得神秘钥匙 x1");
                    gameState.caveExplored = true;
                    updateInventory();
                    
                    // 更新任务
                    addToLog("任务：前往巨龙山脉击败红龙", "quest");
                    gameState.questStep = 3;
                }
                
                updateStats();
                return;
            }
            
            // 遇到敌人
            const enemyList = enemies[gameState.location];
            const enemy = {...enemyList[Math.floor(Math.random() * enemyList.length)]};
            
      
            gameState.enemy = enemy;
            
            gameState.inCombat = true;
            
            // 显示战斗界面
            updateCombatUI();
            updateEnemyInfo();
            
            addToLog(`你在${locationNames[gameState.location]}遇到了一只${gameState.enemy.name}！`, "event");
            addToLog(`战斗开始！${gameState.enemy.name}向你扑来！`);
        }
        
        // 更新敌人信息
        function updateEnemyInfo() {
            if (!gameState.enemy) return;
            
            enemyNameEl.textContent = gameState.enemy.name;
            enemyHealthEl.textContent = `${gameState.enemy.health}/${gameState.enemy.maxHealth}`;
            enemyAttackEl.textContent = gameState.enemy.attack;
            enemyImageEl.textContent = gameState.enemy.emoji;
            
            // 更新敌人血条
            const healthPercent = (gameState.enemy.health / gameState.enemy.maxHealth) * 100;
            enemyHealthBar.style.width = `${healthPercent}%`;
        }
        
        // 玩家攻击
        function playerAttack() {
            if (!gameState.inCombat || !gameState.enemy) return;
            
            disableCombatButtons()
            // 计算伤害（有10%几率暴击）
            const isCritical = Math.random() < 0.1;
            let damage = gameState.attack + Math.floor(Math.random() * 6);
            
            if (isCritical) {
                damage = Math.floor(damage * 1.8);
                addToLog("暴击！", "damage");
            }
            
            gameState.enemy.health -= damage;
            
            addToLog(`你对${gameState.enemy.name}造成了${damage}点伤害！`, "damage");
            updateEnemyInfo();
            
            if (gameState.enemy.health <= 0) {
                enemyDefeated();
                return;
            }
            
            // 敌人反击
            setTimeout(enemyAttack, 800);
        }
        
        // 敌人攻击
        function enemyAttack() {
            if (!gameState.inCombat || !gameState.enemy) return;
            
            // 计算伤害（玩家有15%几率闪避）
            const isDodged = Math.random() < 0.15;
            if (isDodged) {
                addToLog(`你闪避了${gameState.enemy.name}的攻击！`, "event");
                enableCombatButtons()
                return;
            }
            
            let damage = Math.max(1, gameState.enemy.attack + Math.floor(Math.random() * 4) - Math.floor(gameState.defense / 3));
            gameState.health -= damage;
            
            addToLog(`${gameState.enemy.name}对你造成了${damage}点伤害！`, "damage");
            updateStats();
            enableCombatButtons()
            if (gameState.health <= 0) {
                gameOver();
                return;
            }
        }
        
        // 敌人被击败
        function enemyDefeated() {
            gameState.monstersDefeated++;
            addToLog(`你击败了${gameState.enemy.name}！`, "event");
            enableCombatButtons();
            // 获取奖励
            const goldGain = Math.floor(Math.random() * (gameState.enemy.maxGold - gameState.enemy.minGold + 1)) + gameState.enemy.minGold;
            gameState.gold += goldGain;
            gameState.exp += gameState.enemy.exp;
            
            addToLog(`获得了${goldGain}金币和${gameState.enemy.exp}经验值！`, "gold");
            showNotification(`获得 ${goldGain} 金币和 ${gameState.enemy.exp} 经验值！`);
            
            // 特殊掉落
            if (Math.random() < 0.15) {
                gameState.potions++;
                addToLog("获得了1瓶生命药水！", "heal");
                showNotification("获得生命药水 x1");
            }
            
            
            // 任务系统
            if (gameState.location === 'forest' && gameState.questStep === 1) {
                gameState.forestKills++;
                if (gameState.forestKills >= 3) {
                    gameState.questStep = 2;
                    addToLog("任务完成：击败幽暗森林的怪物！", "quest");
                    addToLog("任务：探索神秘洞穴并找到钥匙", "quest");
                }
            }
            
            // 击败红龙
            if (gameState.enemy.name === "红龙") {
                gameState.dragonDefeated = true;
                gameState.gameCompleted = true;
                addToLog("你击败了远古红龙，拯救了王国！", "victory");
                showNotification("恭喜！你击败了红龙！");
                
                // 显示胜利界面
                finalLevel.textContent = gameState.level;
                finalGold.textContent = gameState.gold;
                finalMonsters.textContent = gameState.monstersDefeated;
                
                setTimeout(() => {
                    gameScreen.classList.remove('active');
                    endScreen.classList.add('active');
                }, 3000);
            }
            
            // 检查升级
            checkLevelUp();
            updateInventory();
            
            // 结束战斗
            gameState.inCombat = false;
            gameState.enemy = null;
            updateCombatUI();
            
            updateStats();
        }
        
        // 检查升级
        function checkLevelUp() {
            if (gameState.exp >= gameState.nextLevelExp) {
                gameState.level++;
                gameState.exp -= gameState.nextLevelExp;
                gameState.nextLevelExp = Math.floor(gameState.nextLevelExp * 1.6);
                
                gameState.maxHealth += 25;
                gameState.health = gameState.maxHealth;
                gameState.maxMana += 15;
                gameState.mana = gameState.maxMana;
                gameState.attack += 6;
                gameState.defense += 3;
                
                addToLog(`恭喜！你升到了${gameState.level}级！生命值+25，魔法值+15，攻击力+6，防御力+3`, "event");
                showNotification(`升级到 ${gameState.level} 级！`);
            }
        }
        
        // 使用药水
        function usePotion() {
            if (gameState.potions > 0) {
                gameState.potions--;
                const healAmount = Math.floor(gameState.maxHealth * 0.6);
                gameState.health = Math.min(gameState.maxHealth, gameState.health + healAmount);
                
                addToLog(`你使用了一瓶生命药水，恢复了${healAmount}点生命值。`, "heal");
                updateStats();
                updateInventory();
                // 敌人反击
                setTimeout(enemyAttack, 800);
            } else {
                addToLog("你没有生命药水了！", "event");
            }
        }
        
        // 使用技能
        function useSkill() {
            const charClass = classes[gameState.characterClass];
            
            if (gameState.mana < 20) {
                addToLog("魔法值不足，无法使用技能！", "event");
                return;
            }
            
            gameState.mana -= 20;
            disableCombatButtons()

            let damage = 0;
            switch(gameState.characterClass) {
                case 'warrior':
                    damage = Math.floor(gameState.attack * 1.8);
                    addToLog(`你使用了${charClass.skill}，对${gameState.enemy.name}造成了${damage}点伤害！`, "damage");
                    break;
                case 'mage':
                    damage = Math.floor(gameState.attack * 1.5);
                    // 火焰风暴有2回合持续伤害
                    addToLog(`你使用了${charClass.skill}，对${gameState.enemy.name}造成了${damage}点伤害并使其燃烧！`, "damage");
                    // 下一回合额外伤害
                    setTimeout(() => {
                        if (gameState.inCombat && gameState.enemy) {
                            const extraDamage = Math.floor(damage * 0.4);
                            gameState.enemy.health -= extraDamage;
                            addToLog(`${gameState.enemy.name}受到${extraDamage}点燃烧伤害！`, "damage");
                            updateEnemyInfo();
                            
                            if (gameState.enemy.health <= 0) {
                                enemyDefeated();
                                return;
                            }
                        }
                    }, 1000);
                    break;
                case 'ranger':
                    damage = gameState.attack + 15; // 必定命中并额外伤害
                    addToLog(`你使用了${charClass.skill}，对${gameState.enemy.name}造成了${damage}点伤害！`, "damage");
                    break;
            }
            
            gameState.enemy.health -= damage;
            updateEnemyInfo();
            
            if (gameState.enemy.health <= 0) {
                enemyDefeated();
                return;
            }
            
            updateStats();
            setTimeout(enemyAttack, 1000);
        }
        
        // 逃跑
        function flee() {
            if (!gameState.inCombat) return;

            disableCombatButtons()
            // 70%的几率逃跑成功
            if (Math.random() < 0.7) {
                addToLog("你成功逃离了战斗！", "event");
                gameState.inCombat = false;
                gameState.enemy = null;
                updateCombatUI();
                enableCombatButtons();
            } else {
                addToLog("逃跑失败！", "event");
                setTimeout(enemyAttack, 800);
            }
        }
        
        // 休息恢复
        function rest() {
            if (gameState.inCombat) {
                addToLog("你正在战斗中，无法休息！", "event");
                return;
            }
            
            gameState.health = gameState.maxHealth;
            gameState.mana = gameState.maxMana;
            addToLog("你休息了一会儿，生命值和魔法值完全恢复了。", "heal");
            updateStats();
        }
        
        // 访问商店
        function visitShop() {
            if (gameState.inCombat) {
                addToLog("你正在战斗中，无法访问商店！", "event");
                return;
            }
            
            if (gameState.gold >= 30) {
                gameState.gold -= 30;
                gameState.potions++;
                addToLog("你花费30金币购买了一瓶生命药水。", "gold");
                updateStats();
                updateInventory();
                showNotification("购买生命药水 x1");
            } else {
                addToLog("金币不足，无法购买生命药水！", "event");
            }
        }
        
        // 升级装备
        function upgradeEquipment() {
            if (gameState.inCombat) {
                addToLog("你正在战斗中，无法升级装备！", "event");
                return;
            }
            
            if (gameState.gold >= 100) {
                gameState.gold -= 100;
                gameState.attack += 5;
                addToLog("你花费100金币升级了武器，攻击力+5！", "gold");
                updateStats();
                showNotification("攻击力 +5");
            } else {
                addToLog("升级武器需要100金币！", "event");
            }
        }
        
        // 移动到新区域
        function moveTo(location) {
            if (gameState.inCombat) {
                addToLog("你正在战斗中，无法移动！", "event");
                return;
            }
            
            // 巨龙山脉需要钥匙
            if (location === 'mountain' && gameState.keys < 1) {
                addToLog("你需要神秘钥匙才能进入巨龙山脉！", "event");
                return;
            }
            
            // 洞穴需要完成森林任务
            if (location === 'cave' && gameState.questStep < 2) {
                addToLog("你需要先完成森林任务才能进入洞穴！", "event");
                return;
            }
            
            gameState.location = location;
            locationEl.textContent = locationNames[location];
            addToLog(`你来到了${locationNames[location]}。`, "event");
            
            // 特殊区域事件
            if (location === 'cave') {
                addToLog("洞穴中弥漫着神秘的气息，深处似乎隐藏着宝藏...", "event");
                if (gameState.questStep === 2) {
                    addToLog("任务：在洞穴深处找到神秘钥匙", "quest");
                }
            } else if (location === 'mountain') {
                addToLog("巨龙山脉寒风凛冽，远处传来巨龙的咆哮声...", "event");
                if (gameState.questStep === 3) {
                    addToLog("任务：击败远古红龙", "quest");
                }
            }
        }
        
        // 游戏结束
        function gameOver() {
            addToLog("你被击败了...游戏结束！", "event");
            addToLog("按F5刷新页面重新开始游戏。");
            gameState.inCombat = false;
            updateCombatUI();
            enableCombatButtons();
        }
        
        // 保存游戏
        function saveGame() {
            localStorage.setItem('textRPG_save', JSON.stringify(gameState));
            addToLog("游戏进度已保存！", "event");
            showNotification("游戏进度已保存");
        }
        
        // 加载游戏
        function loadGame() {
            const saveData = localStorage.getItem('textRPG_save');
            if (saveData) {
                try {
                    const savedState = JSON.parse(saveData);
                    Object.assign(gameState, savedState);
                    
                    // 更新角色显示
                    const charClass = classes[gameState.characterClass];
                    playerIcon.textContent = charClass.icon;
                    playerName.textContent = charClass.name;
                    playerClass.textContent = charClass.name;
                    
                    updateStats();
                    locationEl.textContent = locationNames[gameState.location];
                    updateInventory();
                    
                    // 切换到游戏界面
                    startScreen.classList.remove('active');
                    gameScreen.classList.add('active');
                    
                    addToLog("游戏进度已加载！", "event");
                    showNotification("游戏进度已加载");
                } catch (e) {
                    alert("加载存档失败！");
                }
            } else {
                alert("没有找到存档！");
            }
        }
        
        // 事件监听
        document.getElementById('exploreBtn').addEventListener('click', explore);
        document.getElementById('restBtn').addEventListener('click', rest);
        document.getElementById('shopBtn').addEventListener('click', visitShop);
        document.getElementById('upgradeBtn').addEventListener('click', upgradeEquipment);
        document.getElementById('forestBtn').addEventListener('click', () => moveTo('forest'));
        document.getElementById('caveBtn').addEventListener('click', () => moveTo('cave'));
        document.getElementById('mountainBtn').addEventListener('click', () => moveTo('mountain'));
        document.getElementById('attackBtn').addEventListener('click', playerAttack);
        document.getElementById('skillBtn').addEventListener('click', useSkill);
        document.getElementById('potionBtn').addEventListener('click', usePotion);
        document.getElementById('fleeBtn').addEventListener('click', flee);
        document.getElementById('saveBtn').addEventListener('click', saveGame);
        document.getElementById('menuBtn').addEventListener('click', () => {
            gameScreen.classList.remove('active');
            startScreen.classList.add('active');
        });
        document.getElementById('restartBtn').addEventListener('click', () => {
            endScreen.classList.remove('active');
            startScreen.classList.add('active');
        });
        
        // 角色选择
        const characters = document.querySelectorAll('.character');
        characters.forEach(character => {
            character.addEventListener('click', () => {
                // 移除之前的选择
                characters.forEach(c => c.classList.remove('selected'));
                
                // 设置当前选择
                character.classList.add('selected');
                gameState.characterClass = character.dataset.class;
            });
        });
        
        // 新游戏按钮
        document.getElementById('newGameBtn').addEventListener('click', startNewGame);
        
        // 继续游戏按钮
        document.getElementById('continueBtn').addEventListener('click', loadGame);
        
        // 默认选择战士
        document.querySelector('.character[data-class="warrior"]').classList.add('selected');
    </script>
</body>
</html>
