<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¼˜åŒ–ç‰ˆæ–‡å­—å†’é™© RPG</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', 'Microsoft YaHei', sans-serif;
        }
        
        body {
            background: radial-gradient(circle at center, #0f1a3d, #1a2a6c, #0c1026);
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow-x: hidden;
        }
        
        .container {
            max-width: 1200px;
            width: 100%;
            background: rgba(10, 15, 30, 0.85);
            border-radius: 20px;
            box-shadow: 0 15px 40px rgba(0, 0, 0, 0.7);
            overflow: hidden;
            border: 2px solid #3a506b;
            position: relative;
        }
        
        /* è£…é¥°æ•ˆæœ */
        .decoration {
            position: absolute;
            opacity: 0.1;
        }
        
        .decoration.sword {
            top: 50px;
            right: 30px;
            font-size: 5rem;
            transform: rotate(30deg);
        }
        
        .decoration.shield {
            bottom: 80px;
            left: 30px;
            font-size: 4rem;
            transform: rotate(-15deg);
        }
        
        header {
            background: linear-gradient(to right, #0c2d6b, #1a3a8f);
            padding: 25px;
            text-align: center;
            border-bottom: 4px solid #d4af37;
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" width="100" height="100"><path d="M0 0 L100 0 L100 100 L0 100 Z" fill="none" stroke="%23d4af37" stroke-width="1" stroke-dasharray="5,5"/></svg>');
            opacity: 0.3;
        }
        
        h1 {
            font-size: 3.2rem;
            margin-bottom: 10px;
            color: #ffd700;
            text-shadow: 0 0 15px rgba(255, 215, 0, 0.7);
            letter-spacing: 2px;
            position: relative;
            z-index: 2;
            font-weight: 800;
        }
        
        .subtitle {
            color: #a8c6ff;
            font-size: 1.3rem;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
            position: relative;
            z-index: 2;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        
        .game-container {
            display: flex;
            padding: 25px;
            gap: 25px;
        }
        
        .left-panel {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .player-section {
            background: rgba(20, 30, 50, 0.7);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
            border: 1px solid #3a506b;
            position: relative;
        }
        
        .combat-section {
            background: rgba(20, 30, 50, 0.7);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
            border: 1px solid #3a506b;
            min-height: 300px;
        }
        
        .right-panel {
            flex: 1.5;
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .game-section {
            background: rgba(20, 30, 50, 0.7);
            border-radius: 15px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.4);
            border: 1px solid #3a506b;
        }
        
        .section-title {
            font-size: 1.7rem;
            color: #ffd700;
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 2px solid #3a506b;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .section-title i {
            color: #d4af37;
        }
        
        .status-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .status-bar {
            display: flex;
            justify-content: space-between;
            background: linear-gradient(to right, #1c2e4a, #2c3e50);
            padding: 14px;
            border-radius: 10px;
            margin-bottom: 5px;
            border: 1px solid #3a506b;
            box-shadow: 0 3px 6px rgba(0,0,0,0.3);
            transition: transform 0.2s;
        }
        
        .status-bar:hover {
            transform: translateY(-3px);
        }
        
        .status-label {
            font-weight: bold;
            color: #ffd700;
            display: flex;
            align-items: center;
            gap: 8px;
            min-width: 100px;
        }
        
        .status-value {
            text-align: right;
            flex: 1;
        }
        
        .progress-bar {
            height: 6px;
            background: rgba(0,0,0,0.3);
            border-radius: 3px;
            margin-top: 5px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            border-radius: 3px;
        }
        
        .health-fill {
            background: linear-gradient(to right, #ff416c, #ff4b2b);
        }
        
        .mana-fill {
            background: linear-gradient(to right, #2193b0, #6dd5ed);
        }
        
        .exp-fill {
            background: linear-gradient(to right, #00b09b, #96c93d);
        }
        
        .inventory {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }
        
        .item {
            background: linear-gradient(to bottom right, #2c3e50, #1c2e4a);
            padding: 12px;
            border-radius: 10px;
            text-align: center;
            border: 1px solid #3a506b;
            box-shadow: 0 3px 6px rgba(0,0,0,0.2);
            transition: transform 0.2s;
            cursor: pointer;
            position: relative;
        }
        
        .item:hover {
            transform: translateY(-3px);
            background: linear-gradient(to bottom right, #3a506b, #2c3e50);
        }
        
        .item-icon {
            font-size: 2rem;
            margin-bottom: 8px;
            color: #ffd700;
        }
        
        .item-count {
            position: absolute;
            top: 5px;
            right: 8px;
            background: #d4af37;
            color: #000;
            font-weight: bold;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9rem;
        }
        
        .game-log {
            background: rgba(0, 0, 0, 0.4);
            border-radius: 10px;
            padding: 20px;
            height: 320px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            line-height: 1.7;
            margin-bottom: 15px;
            border: 1px solid #3a506b;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.5);
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><rect width="100" height="100" fill="none" stroke="%233a506b" stroke-width="0.5"/></svg>');
        }
        
        .game-log p {
            margin-bottom: 10px;
            padding: 8px 12px;
            border-radius: 6px;
            background: rgba(0,0,0,0.2);
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .action-buttons {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }
        
        .location-buttons {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-top: 10px;
        }
        
        .combat-buttons {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
        }
        
        button {
            background: linear-gradient(to bottom, #d4af37, #b8860b);
            color: #1a1a2e;
            border: none;
            padding: 14px;
            border-radius: 10px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            text-shadow: 0 1px 0 rgba(255, 255, 255, 0.3);
            font-size: 1.05rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            border: 1px solid #ffd700;
        }
        
        button:hover {
            background: linear-gradient(to bottom, #ffd700, #daa520);
            transform: translateY(-3px);
            box-shadow: 0 7px 14px rgba(0, 0, 0, 0.3);
        }
        
        button:active {
            transform: translateY(1px);
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
        }
        
        button:disabled {
            background: #444;
            color: #777;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
            border: 1px solid #555;
            position: relative;
            overflow: hidden;
        }
        
        button:disabled::after {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
        }
        
        .save-load {
            display: flex;
            gap: 12px;
            margin-top: 15px;
        }
        
        .save-load button {
            flex: 1;
        }
        
        .player-info {
            text-align: center;
            position: relative;
            padding: 15px 0;
        }
        
        .player-image {
            font-size: 6rem;
            margin: 10px 0;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.7);
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.5));
            transition: transform 0.3s;
        }
        
        .player-image:hover {
            transform: scale(1.1) rotate(5deg);
        }
        
        .player-name {
            font-size: 1.4rem;
            color: #ffd700;
            margin-top: 5px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.5);
        }
        
        .player-class {
            color: #a8c6ff;
            font-size: 1.1rem;
            margin-top: 3px;
        }
        
        .enemy-info {
            background: linear-gradient(to right, #4b0000, #8b0000);
            padding: 10px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
            border: 1px solid #ff5555;
            box-shadow: 0 5px 15px rgba(139, 0, 0, 0.4);
            position: relative;
        }
        
        .enemy-image {
            font-size: 5rem;
            margin-bottom: 15px;
            text-shadow: 0 0 15px rgba(255, 0, 0, 0.5);
            filter: drop-shadow(0 5px 10px rgba(0,0,0,0.5));
        }
        
        .enemy-stats {
            display: flex;
            justify-content: center;
            gap: 25px;
            margin-top: 15px;
        }
        
        .enemy-stat {
            background: rgba(0,0,0,0.3);
            padding: 10px 20px;
            border-radius: 10px;
            min-width: 100px;
        }
        
        .event {
            color: #ffcc00;
            border-left: 3px solid #ffcc00;
        }
        
        .damage {
            color: #ff5555;
            background: rgba(139, 0, 0, 0.2);
        }
        
        .heal {
            color: #55ff55;
            background: rgba(0, 100, 0, 0.2);
        }
        
        .gold {
            color: #ffd700;
            background: rgba(184, 134, 11, 0.2);
        }
        
        .quest {
            color: #55ffff;
            border-left: 3px solid #55ffff;
        }
        
        .victory {
            color: #96c93d;
            border-left: 3px solid #96c93d;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            background: linear-gradient(to right, #0c2d6b, #1a3a8f);
            color: #a8c6ff;
            font-size: 1rem;
            border-top: 1px solid #3a506b;
        }
        
        .xp-bar {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 5px;
        }
        
        .xp-text {
            font-size: 0.9rem;
            color: #aaa;
        }
        
        .level-badge {
            background: #d4af37;
            color: #000;
            font-weight: bold;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.9rem;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            background: linear-gradient(to right, #0c2d6b, #1a3a8f);
            color: white;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            transform: translateX(200%);
            transition: transform 0.3s ease;
            z-index: 1000;
            border-left: 5px solid #d4af37;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .skill-cooldown {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            color: white;
            z-index: 10;
            border-radius: 10px;
        }
        
        .combat-controls {
            position: relative;
        }
        
        @media (max-width: 900px) {
            .game-container {
                flex-direction: column;
            }
            
            .left-panel, .right-panel {
                width: 100%;
            }
            
            .inventory {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media (max-width: 600px) {
            .action-buttons, .location-buttons, .combat-buttons {
                grid-template-columns: 1fr;
            }
            
            .player-image {
                font-size: 4.5rem;
            }
            
            .enemy-image {
                font-size: 3.5rem;
            }
            
            .enemy-stats {
                flex-direction: column;
                gap: 10px;
            }
            
            .status-container {
                grid-template-columns: 1fr;
            }
            
            .section-title {
                font-size: 1.4rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="decoration sword">âš”ï¸</div>
        <div class="decoration shield">ğŸ›¡ï¸</div>
        
        <header>
            <h1>æ–‡å­—å†’é™© RPG</h1>
            <div class="subtitle">æ¢ç´¢ä¸–ç•Œ Â· æ”¶é›†å®è— Â· æˆ˜èƒœæ•Œäºº</div>
        </header>
        
        <div class="game-container">
            <!-- å·¦ä¾§é¢æ¿ï¼šç©å®¶ä¿¡æ¯å’Œæˆ˜æ–— -->
            <div class="left-panel">
                <div class="player-section">
                    <h2 class="section-title"><i class="fas fa-user"></i> å†’é™©è€…ä¿¡æ¯</h2>
                    
                    <div class="player-info">
                        <div class="player-image">ğŸ§™â€â™‚ï¸</div>
                        <div class="player-name">è‰¾åˆ©å…‹æ–¯</div>
                        <div class="player-class">é­”æ³•æˆ˜å£«</div>
                    </div>
                    
                    <div class="status-container">
                        <div class="status-bar">
                            <span class="status-label"><i class="fas fa-heart"></i> ç”Ÿå‘½å€¼:</span>
                            <span class="status-value" id="health">100/100</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill health-fill" id="health-bar" style="width: 100%"></div>
                        </div>
                        
                        <div class="status-bar">
                            <span class="status-label"><i class="fas fa-fire"></i> é­”æ³•å€¼:</span>
                            <span class="status-value" id="mana">50/50</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill mana-fill" id="mana-bar" style="width: 100%"></div>
                        </div>
                        
                        <div class="status-bar">
                            <span class="status-label"><i class="fas fa-shield-alt"></i> æ”»å‡»åŠ›:</span>
                            <span class="status-value" id="attack">15</span>
                        </div>
                        
                        <div class="status-bar">
                            <span class="status-label"><i class="fas fa-shield-virus"></i> é˜²å¾¡åŠ›:</span>
                            <span class="status-value" id="defense">8</span>
                        </div>
                        
                        <div class="status-bar">
                            <span class="status-label"><i class="fas fa-coins"></i> é‡‘å¸:</span>
                            <span class="status-value" id="gold">50</span>
                        </div>
                        
                        <div class="status-bar">
                            <span class="status-label"><i class="fas fa-star"></i> ç»éªŒå€¼:</span>
                            <div class="status-value">
                                <div class="xp-bar">
                                    <span id="exp">0/100</span>
                                    <span class="level-badge">Lv.<span id="level">1</span></span>
                                </div>
                            </div>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill exp-fill" id="exp-bar" style="width: 0%"></div>
                        </div>
                    </div>
                    
                    <h3 class="section-title"><i class="fas fa-backpack"></i> èƒŒåŒ…</h3>
                    <div class="inventory" id="inventory">
                        <div class="item" id="health-potion">
                            <div class="item-icon">â¤ï¸</div>
                            <div>ç”Ÿå‘½è¯æ°´</div>
                            <div class="item-count" id="potion-count">1</div>
                        </div>
                        <div class="item" id="mana-potion">
                            <div class="item-icon">ğŸ’§</div>
                            <div>é­”æ³•è¯æ°´</div>
                            <div class="item-count" id="mana-potion-count">0</div>
                        </div>
                        <div class="item" id="attack-potion">
                            <div class="item-icon">âš”ï¸</div>
                            <div>æ”»å‡»è¯å‰‚</div>
                            <div class="item-count" id="attack-potion-count">0</div>
                        </div>
                        <div class="item" id="defense-potion">
                            <div class="item-icon">ğŸ›¡ï¸</div>
                            <div>é˜²å¾¡è¯å‰‚</div>
                            <div class="item-count" id="defense-potion-count">0</div>
                        </div>
                        <div class="item" id="key-item">
                            <div class="item-icon">ğŸ”‘</div>
                            <div>ç¥ç§˜é’¥åŒ™</div>
                            <div class="item-count" id="key-count">0</div>
                        </div>
                        <div class="item" id="gem-item">
                            <div class="item-icon">ğŸ’</div>
                            <div>é­”æ³•å®çŸ³</div>
                            <div class="item-count" id="gem-count">0</div>
                        </div>
                    </div>
                    
                    <div class="save-load">
                        <button id="saveBtn"><i class="fas fa-save"></i> ä¿å­˜è¿›åº¦</button>
                        <button id="loadBtn"><i class="fas fa-folder-open"></i> è¯»å–è¿›åº¦</button>
                    </div>
                </div>
                
                
            </div>
            
            <!-- å³ä¾§é¢æ¿ï¼šæ—¥å¿—å’Œæ¸¸æˆæ“ä½œ -->
            <div class="right-panel">
                <div class="game-section">
                    <div class="combat-section">
                        <h2 class="section-title"><i class="fas fa-fist-raised"></i> æˆ˜æ–—çŠ¶æ€</h2>
                        
                        <div id="combatSection" style="display: none;">
                            <div class="enemy-info">
                                <div class="enemy-image" id="enemyImage">ğŸº</div>
                                <div style="font-size: 1.3rem; margin-bottom: 10px;">æ•Œäºº: <span id="enemyName">é‡ç‹¼</span></div>
                                
                                <div class="enemy-stats">
                                    <div class="enemy-stat">
                                        <div>ç”Ÿå‘½å€¼</div>
                                        <div id="enemyHealth">40/40</div>
                                        <div class="progress-bar">
                                            <div class="progress-fill health-fill" id="enemy-health-bar" style="width: 100%"></div>
                                        </div>
                                    </div>
                                    <div class="enemy-stat">
                                        <div>æ”»å‡»åŠ›</div>
                                        <div id="enemyAttack">10</div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="combat-controls">
                                <div class="combat-buttons">
                                    <button id="attackBtn"><i class="fas fa-fist-raised"></i> æ”»å‡»</button>
                                    <button id="skillBtn"><i class="fas fa-magic"></i> æŠ€èƒ½</button>
                                    <button id="potionBtn"><i class="fas fa-wine-bottle"></i> è¯æ°´</button>
                                    <button id="fleeBtn"><i class="fas fa-running"></i> é€ƒè·‘</button>
                                </div>
                            </div>
                        </div>
                        
                        <div id="noCombatSection" style="text-align: center; padding: 40px 20px;">
                            <div style="font-size: 4rem; margin-bottom: 20px;">âš”ï¸</div>
                            <p>å½“å‰æ²¡æœ‰æˆ˜æ–—</p>
                            <p class="event" style="margin-top: 10px;">æ¢ç´¢åŒºåŸŸå¯èƒ½ä¼šé‡åˆ°æ•Œäººï¼</p>
                        </div>
                    </div>
                    
                    <h3 class="section-title"><i class="fas fa-map-marker-alt"></i> å½“å‰ä½ç½®: <span id="location">å®é™æ‘åº„</span></h3>
                    
                    <div class="action-buttons">
                        <button id="exploreBtn"><i class="fas fa-binoculars"></i> æ¢ç´¢å½“å‰åŒºåŸŸ</button>
                        <button id="restBtn"><i class="fas fa-bed"></i> ä¼‘æ¯æ¢å¤</button>
                        <button id="shopBtn"><i class="fas fa-shopping-cart"></i> è®¿é—®å•†åº—</button>
                        <button id="upgradeBtn"><i class="fas fa-tools"></i> å‡çº§è£…å¤‡</button>
                    </div>
                    
                    <div class="location-buttons">
                        <button id="forestBtn"><i class="fas fa-tree"></i> å¹½æš—æ£®æ—</button>
                        <button id="caveBtn"><i class="fas fa-mountain"></i> ç¥ç§˜æ´ç©´</button>
                        <button id="mountainBtn"><i class="fas fa-dragon"></i> å·¨é¾™å±±è„‰</button>
                    </div>
                    <h2 class="section-title"><i class="fas fa-scroll"></i> å†’é™©æ—¥å¿—</h2>
                    <div class="game-log" id="gameLog">
                        <p>æ¬¢è¿æ¥åˆ°æ–‡å­—RPGä¸–ç•Œï¼ä½ æ˜¯ä¸€ååˆå‡ºèŒ…åºçš„å†’é™©è€…ã€‚</p>
                        <p>ä½ å‡ºç°åœ¨ä¸€ä¸ªå°æ‘åº„çš„å¹¿åœºä¸Šã€‚æ‘æ°‘ä»¬çœ‹èµ·æ¥æœ‰äº›ä¸å®‰ï¼Œä¼¼ä¹æœ‰äº‹æƒ…å‘ç”Ÿã€‚</p>
                        <p class="event">æ‘é•¿å‘Šè¯‰ä½ ï¼šæœ€è¿‘æ‘åº„é™„è¿‘å‡ºç°äº†æ€ªç‰©ï¼Œè¯·å¸®å¸®æˆ‘ä»¬ï¼</p>
                        <p class="quest">ä»»åŠ¡ï¼šå‡»è´¥å¹½æš—æ£®æ—çš„æ€ªç‰©ï¼ˆ0/3ï¼‰</p>
                    </div>

                </div>
            </div>
        </div>
        
        <footer>
            <p>ä¼˜åŒ–ç‰ˆæ–‡å­—å†’é™© RPG | ä½¿ç”¨HTML5, CSS3å’ŒJavaScriptæ„å»º | æŒ‰F5é‡æ–°å¼€å§‹æ¸¸æˆ</p>
        </footer>
    </div>

    <div class="notification" id="notification">é€šçŸ¥æ¶ˆæ¯</div>

    <script>
        // æ¸¸æˆçŠ¶æ€
        const gameState = {
            health: 100,
            maxHealth: 100,
            mana: 50,
            maxMana: 50,
            attack: 15,
            defense: 8,
            gold: 50,
            exp: 0,
            level: 1,
            potions: 1,
            manaPotions: 0,
            attackPotions: 0,
            defensePotions: 0,
            keys: 0,
            gems: 0,
            location: 'village',
            inCombat: false,
            enemy: null,
            nextLevelExp: 100,
            forestKills: 0,
            questCompleted: false,
            actionInProgress: false,
            skillCooldown: 0
        };
        
        // æ•Œäººæ•°æ®
        const enemies = {
            forest: [
                { name: "é‡ç‹¼", health: 40, maxHealth: 40, attack: 10, minGold: 5, maxGold: 15, exp: 30, emoji: "ğŸº" },
                { name: "å·¨èœ˜è››", health: 30, maxHealth: 30, attack: 12, minGold: 8, maxGold: 18, exp: 40, emoji: "ğŸ•·ï¸" },
                { name: "æ£®æ—å·¨ç†Š", health: 80, maxHealth: 80, attack: 18, minGold: 20, maxGold: 35, exp: 70, emoji: "ğŸ»" }
            ],
            cave: [
                { name: "æ´ç©´è™è ", health: 25, maxHealth: 25, attack: 8, minGold: 3, maxGold: 10, exp: 20, emoji: "ğŸ¦‡" },
                { name: "å‰§æ¯’èå­", health: 35, maxHealth: 35, attack: 14, minGold: 10, maxGold: 20, exp: 45, emoji: "ğŸ¦‚" },
                { name: "çŸ³åƒé¬¼", health: 100, maxHealth: 100, attack: 22, minGold: 30, maxGold: 50, exp: 100, emoji: "ğŸ—¿" }
            ],
            mountain: [
                { name: "å±±é¹°", health: 45, maxHealth: 45, attack: 16, minGold: 15, maxGold: 25, exp: 50, emoji: "ğŸ¦…" },
                { name: "é›ªæ€ª", health: 120, maxHealth: 120, attack: 26, minGold: 40, maxGold: 70, exp: 150, emoji: "â„ï¸" },
                { name: "çº¢é¾™", health: 300, maxHealth: 300, attack: 40, minGold: 100, maxGold: 200, exp: 500, emoji: "ğŸ‰" }
            ]
        };
        
        // ä½ç½®åç§°æ˜ å°„
        const locationNames = {
            village: "å®é™æ‘åº„",
            forest: "å¹½æš—æ£®æ—",
            cave: "ç¥ç§˜æ´ç©´",
            mountain: "å·¨é¾™å±±è„‰"
        };
        
        // æŠ€èƒ½æ•°æ®
        const skills = [
            { name: "ç«çƒæœ¯", cost: 15, damage: 25, description: "å‘å°„ä¸€ä¸ªç«çƒæ”»å‡»æ•Œäºº" },
            { name: "æ²»ç–—æœ¯", cost: 20, heal: 30, description: "æ¢å¤è‡ªèº«ç”Ÿå‘½å€¼" },
            { name: "é›·éœ†ä¸€å‡»", cost: 25, damage: 35, description: "å¬å”¤é—ªç”µæ”»å‡»æ•Œäºº" }
        ];
        
        // DOM å…ƒç´ 
        const gameLog = document.getElementById('gameLog');
        const healthEl = document.getElementById('health');
        const manaEl = document.getElementById('mana');
        const attackEl = document.getElementById('attack');
        const defenseEl = document.getElementById('defense');
        const goldEl = document.getElementById('gold');
        const expEl = document.getElementById('exp');
        const levelEl = document.getElementById('level');
        const potionCountEl = document.getElementById('potion-count');
        const manaPotionCountEl = document.getElementById('mana-potion-count');
        const attackPotionCountEl = document.getElementById('attack-potion-count');
        const defensePotionCountEl = document.getElementById('defense-potion-count');
        const keyCountEl = document.getElementById('key-count');
        const gemCountEl = document.getElementById('gem-count');
        const locationEl = document.getElementById('location');
        const combatSection = document.getElementById('combatSection');
        const noCombatSection = document.getElementById('noCombatSection');
        const enemyNameEl = document.getElementById('enemyName');
        const enemyHealthEl = document.getElementById('enemyHealth');
        const enemyAttackEl = document.getElementById('enemyAttack');
        const enemyImageEl = document.getElementById('enemyImage');
        const healthBar = document.getElementById('health-bar');
        const manaBar = document.getElementById('mana-bar');
        const expBar = document.getElementById('exp-bar');
        const enemyHealthBar = document.getElementById('enemy-health-bar');
        const notification = document.getElementById('notification');
        const attackBtn = document.getElementById('attackBtn');
        const skillBtn = document.getElementById('skillBtn');
        const potionBtn = document.getElementById('potionBtn');
        const fleeBtn = document.getElementById('fleeBtn');
        
        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message) {
            notification.textContent = message;
            notification.classList.add('show');
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // åˆå§‹åŒ–æ¸¸æˆ
        function initGame() {
            updateStats();
            addToLog("æ¸¸æˆå¼€å§‹ï¼ä½ å‡†å¤‡å¥½å†’é™©äº†å—ï¼Ÿ");
            locationEl.textContent = locationNames[gameState.location];
            updateInventory();
            updateCombatUI();
            
            // æ›´æ–°æŠ€èƒ½å†·å´
            updateSkillCooldown();
        }
        
        // æ›´æ–°çŠ¶æ€æ˜¾ç¤º
        function updateStats() {
            healthEl.textContent = `${gameState.health}/${gameState.maxHealth}`;
            manaEl.textContent = `${gameState.mana}/${gameState.maxMana}`;
            attackEl.textContent = gameState.attack;
            defenseEl.textContent = gameState.defense;
            goldEl.textContent = gameState.gold;
            expEl.textContent = `${gameState.exp}/${gameState.nextLevelExp}`;
            levelEl.textContent = gameState.level;
            
            // æ›´æ–°è¿›åº¦æ¡
            const healthPercent = (gameState.health / gameState.maxHealth) * 100;
            healthBar.style.width = `${healthPercent}%`;
            
            const manaPercent = (gameState.mana / gameState.maxMana) * 100;
            manaBar.style.width = `${manaPercent}%`;
            
            const expPercent = (gameState.exp / gameState.nextLevelExp) * 100;
            expBar.style.width = `${expPercent}%`;
        }
        
        // æ›´æ–°èƒŒåŒ…
        function updateInventory() {
            potionCountEl.textContent = gameState.potions;
            manaPotionCountEl.textContent = gameState.manaPotions;
            attackPotionCountEl.textContent = gameState.attackPotions;
            defensePotionCountEl.textContent = gameState.defensePotions;
            keyCountEl.textContent = gameState.keys;
            gemCountEl.textContent = gameState.gems;
        }
        
        // æ·»åŠ æ—¥å¿—
        function addToLog(message, className = "") {
            const p = document.createElement('p');
            if (className) p.className = className;
            p.textContent = message;
            gameLog.appendChild(p);
            gameLog.scrollTop = gameLog.scrollHeight;
        }
        
        // æ›´æ–°æˆ˜æ–—UI
        function updateCombatUI() {
            if (gameState.inCombat && gameState.enemy) {
                combatSection.style.display = 'block';
                noCombatSection.style.display = 'none';
                updateEnemyInfo();
            } else {
                combatSection.style.display = 'none';
                noCombatSection.style.display = 'block';
            }
        }
        
        // æ›´æ–°æ•Œäººä¿¡æ¯
        function updateEnemyInfo() {
            if (!gameState.enemy) return;
            
            enemyNameEl.textContent = gameState.enemy.name;
            enemyHealthEl.textContent = `${gameState.enemy.health}/${gameState.enemy.maxHealth}`;
            enemyAttackEl.textContent = gameState.enemy.attack;
            enemyImageEl.textContent = gameState.enemy.emoji;
            
            // æ›´æ–°æ•Œäººè¡€æ¡
            const healthPercent = (gameState.enemy.health / gameState.enemy.maxHealth) * 100;
            enemyHealthBar.style.width = `${healthPercent}%`;
        }
        
        // ç¦ç”¨æˆ˜æ–—æŒ‰é’®
        function disableCombatButtons() {
            gameState.actionInProgress = true;
            attackBtn.disabled = true;
            skillBtn.disabled = true;
            potionBtn.disabled = true;
            fleeBtn.disabled = true;
        }
        
        // å¯ç”¨æˆ˜æ–—æŒ‰é’®
        function enableCombatButtons() {
            gameState.actionInProgress = false;
            attackBtn.disabled = false;
            skillBtn.disabled = false;
            potionBtn.disabled = false;
            fleeBtn.disabled = false;
            
            // æ›´æ–°æŠ€èƒ½å†·å´çŠ¶æ€
            updateSkillCooldown();
        }
        
        // æ›´æ–°æŠ€èƒ½å†·å´
        function updateSkillCooldown() {
            if (gameState.skillCooldown > 0) {
                skillBtn.disabled = true;
                const cooldownElement = document.createElement('div');
                cooldownElement.className = 'skill-cooldown';
                cooldownElement.textContent = gameState.skillCooldown;
                
                // ç§»é™¤ç°æœ‰çš„å†·å´æ˜¾ç¤º
                const existingCooldown = document.querySelector('.skill-cooldown');
                if (existingCooldown) existingCooldown.remove();
                
                skillBtn.appendChild(cooldownElement);
            } else {
                skillBtn.disabled = false;
                const existingCooldown = document.querySelector('.skill-cooldown');
                if (existingCooldown) existingCooldown.remove();
            }
        }
        
        // å‡å°‘æŠ€èƒ½å†·å´
        function reduceSkillCooldown() {
            if (gameState.skillCooldown > 0) {
                gameState.skillCooldown--;
                updateSkillCooldown();
            }
        }
        
        // æ¢ç´¢å½“å‰åŒºåŸŸ
        function explore() {
            if (gameState.inCombat) {
                addToLog("ä½ æ­£åœ¨æˆ˜æ–—ä¸­ï¼Œæ— æ³•æ¢ç´¢ï¼", "event");
                return;
            }
            
            // 30%çš„å‡ ç‡æ²¡æœ‰é‡åˆ°æ•Œäºº
            if (Math.random() < 0.3) {
                // éšæœºäº‹ä»¶
                const events = [
                    "ä½ åœ¨è¯¥åŒºåŸŸæ¢ç´¢äº†ä¸€ç•ªï¼Œå‘ç°äº†ä¸€äº›æœ‰ç”¨çš„è‰è¯ã€‚",
                    "ä½ å‘ç°äº†ä¸€ä¸ªå®ç®±ï¼Œé‡Œé¢æœ‰ä¸€äº›é‡‘å¸ï¼",
                    "ä½ é‡åˆ°äº†ä¸€ä½æ—…è¡Œå•†äººï¼Œä»–å–ç»™ä½ ä¸€äº›è¯æ°´ã€‚",
                    "ä½ å‘ç°äº†ä¸€ä¸ªåºŸå¼ƒçš„è¥åœ°ï¼Œæ‰¾åˆ°äº†ä¸€äº›è¡¥ç»™ã€‚",
                    "ä½ å‘ç°äº†ä¸€ä¸ªéšè—çš„æ´ç©´å…¥å£ã€‚"
                ];
                
                const event = events[Math.floor(Math.random() * events.length)];
                addToLog(event, "event");
                
                // å¥–åŠ±
                if (Math.random() < 0.4) {
                    const goldGain = Math.floor(Math.random() * 10) + 5;
                    gameState.gold += goldGain;
                    addToLog(`è·å¾—äº†${goldGain}é‡‘å¸ï¼`, "gold");
                    showNotification(`è·å¾— ${goldGain} é‡‘å¸ï¼`);
                }
                
                if (Math.random() < 0.3) {
                    gameState.potions++;
                    addToLog("è·å¾—äº†1ç“¶ç”Ÿå‘½è¯æ°´ï¼", "heal");
                    showNotification("è·å¾—ç”Ÿå‘½è¯æ°´ x1");
                    updateInventory();
                }
                
                updateStats();
                return;
            }
            
            // é‡åˆ°æ•Œäºº
            const enemyList = enemies[gameState.location];
            const enemy = {...enemyList[Math.floor(Math.random() * enemyList.length)]};
            
            gameState.enemy = enemy;
            gameState.inCombat = true;
            
            // æ›´æ–°UI
            updateCombatUI();
            
            addToLog(`ä½ åœ¨${locationNames[gameState.location]}é‡åˆ°äº†ä¸€åª${enemy.name}ï¼`, "event");
            addToLog(`æˆ˜æ–—å¼€å§‹ï¼${enemy.name}å‘ä½ æ‰‘æ¥ï¼`);
        }
        
        // ç©å®¶æ”»å‡»
        function playerAttack() {
            if (!gameState.inCombat || !gameState.enemy || gameState.actionInProgress) return;
            
            disableCombatButtons();
            
            // è®¡ç®—ä¼¤å®³ï¼ˆæœ‰20%å‡ ç‡æš´å‡»ï¼‰
            const isCritical = Math.random() < 0.2;
            let damage = gameState.attack + Math.floor(Math.random() * 6);
            
            if (isCritical) {
                damage = Math.floor(damage * 1.8);
                addToLog("æš´å‡»ï¼", "damage");
            }
            
            gameState.enemy.health -= damage;
            
            addToLog(`ä½ å¯¹${gameState.enemy.name}é€ æˆäº†${damage}ç‚¹ä¼¤å®³ï¼`, "damage");
            updateEnemyInfo();
            
            if (gameState.enemy.health <= 0) {
                setTimeout(enemyDefeated, 1000);
                return;
            }
            
            // æ•Œäººåå‡»
            setTimeout(enemyAttack, 1200);
        }
        
        // æ•Œäººæ”»å‡»
        function enemyAttack() {
            if (!gameState.inCombat || !gameState.enemy) return;
            
            // è®¡ç®—ä¼¤å®³ï¼ˆç©å®¶æœ‰15%å‡ ç‡é—ªé¿ï¼‰
            const isDodged = Math.random() < 0.15;
            if (isDodged) {
                addToLog(`ä½ é—ªé¿äº†${gameState.enemy.name}çš„æ”»å‡»ï¼`, "event");
                enableCombatButtons();
                return;
            }
            
            let damage = Math.max(1, gameState.enemy.attack + Math.floor(Math.random() * 4) - Math.floor(gameState.defense / 3));
            gameState.health -= damage;
            
            addToLog(`${gameState.enemy.name}å¯¹ä½ é€ æˆäº†${damage}ç‚¹ä¼¤å®³ï¼`, "damage");
            updateStats();
            
            if (gameState.health <= 0) {
                gameOver();
                return;
            }
            
            enableCombatButtons();
        }
        
        // æ•Œäººè¢«å‡»è´¥
        function enemyDefeated() {
            addToLog(`ä½ å‡»è´¥äº†${gameState.enemy.name}ï¼`, "event");
            
            // è·å–å¥–åŠ±
            const goldGain = Math.floor(Math.random() * (gameState.enemy.maxGold - gameState.enemy.minGold + 1)) + gameState.enemy.minGold;
            gameState.gold += goldGain;
            gameState.exp += gameState.enemy.exp;
            
            addToLog(`è·å¾—äº†${goldGain}é‡‘å¸å’Œ${gameState.enemy.exp}ç»éªŒå€¼ï¼`, "gold");
            showNotification(`è·å¾— ${goldGain} é‡‘å¸å’Œ ${gameState.enemy.exp} ç»éªŒå€¼ï¼`);
            
            // ç‰¹æ®Šæ‰è½
            if (Math.random() < 0.15) {
                gameState.potions++;
                addToLog("è·å¾—äº†1ç“¶ç”Ÿå‘½è¯æ°´ï¼", "heal");
                showNotification("è·å¾—ç”Ÿå‘½è¯æ°´ x1");
            }
            
            if (Math.random() < 0.1) {
                gameState.manaPotions++;
                addToLog("è·å¾—äº†1ç“¶é­”æ³•è¯æ°´ï¼", "event");
                showNotification("è·å¾—é­”æ³•è¯æ°´ x1");
            }
            
            // å¹½æš—æ£®æ—ä»»åŠ¡
            if (gameState.location === 'forest' && !gameState.questCompleted) {
                gameState.forestKills++;
                if (gameState.forestKills >= 3) {
                    gameState.questCompleted = true;
                    const questReward = 100;
                    gameState.gold += questReward;
                    gameState.exp += 50;
                    addToLog("ä»»åŠ¡å®Œæˆï¼šå‡»è´¥å¹½æš—æ£®æ—çš„æ€ªç‰©ï¼", "quest");
                    addToLog(`è·å¾—äº†${questReward}é‡‘å¸å’Œ50ç»éªŒå€¼ï¼`, "gold");
                    showNotification("ä»»åŠ¡å®Œæˆï¼è·å¾— 100 é‡‘å¸å’Œ 50 ç»éªŒå€¼");
                    
                    // æ·»åŠ æ–°ä»»åŠ¡
                    addToLog("ä»»åŠ¡ï¼šæ¢ç´¢ç¥ç§˜æ´ç©´å¹¶æ‰¾åˆ°é’¥åŒ™", "quest");
                }
            }
            
            // æ£€æŸ¥å‡çº§
            checkLevelUp();
            updateInventory();
            
            // ç»“æŸæˆ˜æ–—
            gameState.inCombat = false;
            gameState.enemy = null;
            updateCombatUI();
            enableCombatButtons();
            
            updateStats();
        }
        
        // æ£€æŸ¥å‡çº§
        function checkLevelUp() {
            if (gameState.exp >= gameState.nextLevelExp) {
                gameState.level++;
                gameState.exp -= gameState.nextLevelExp;
                gameState.nextLevelExp = Math.floor(gameState.nextLevelExp * 1.6);
                
                gameState.maxHealth += 25;
                gameState.health = gameState.maxHealth;
                gameState.maxMana += 15;
                gameState.mana = gameState.maxMana;
                gameState.attack += 6;
                gameState.defense += 3;
                
                addToLog(`æ­å–œï¼ä½ å‡åˆ°äº†${gameState.level}çº§ï¼ç”Ÿå‘½å€¼+25ï¼Œé­”æ³•å€¼+15ï¼Œæ”»å‡»åŠ›+6ï¼Œé˜²å¾¡åŠ›+3`, "event");
                showNotification(`å‡çº§åˆ° ${gameState.level} çº§ï¼`);
            }
        }
        
        // ä½¿ç”¨è¯æ°´
        function usePotion() {
            if (gameState.actionInProgress) return;
            
            if (gameState.potions > 0) {
                disableCombatButtons();
                
                gameState.potions--;
                const healAmount = Math.floor(gameState.maxHealth * 0.6);
                gameState.health = Math.min(gameState.maxHealth, gameState.health + healAmount);
                
                addToLog(`ä½ ä½¿ç”¨äº†ä¸€ç“¶ç”Ÿå‘½è¯æ°´ï¼Œæ¢å¤äº†${healAmount}ç‚¹ç”Ÿå‘½å€¼ã€‚`, "heal");
                updateStats();
                updateInventory();
                
                setTimeout(() => {
                    enemyAttack();
                }, 1000);
            } else {
                addToLog("ä½ æ²¡æœ‰ç”Ÿå‘½è¯æ°´äº†ï¼", "event");
            }
        }
        
        // ä½¿ç”¨æŠ€èƒ½
        function useSkill() {
            if (!gameState.inCombat || !gameState.enemy || gameState.actionInProgress || gameState.skillCooldown > 0) return;
            
            disableCombatButtons();
            gameState.skillCooldown = 3; // 3å›åˆå†·å´
            
            const skill = skills[0]; // ä½¿ç”¨ç¬¬ä¸€ä¸ªæŠ€èƒ½
            gameState.mana -= skill.cost;
            
            if (skill.damage) {
                // æ”»å‡»æŠ€èƒ½
                gameState.enemy.health -= skill.damage;
                addToLog(`ä½ ä½¿ç”¨äº†${skill.name}ï¼Œå¯¹${gameState.enemy.name}é€ æˆäº†${skill.damage}ç‚¹ä¼¤å®³ï¼`, "damage");
                
                if (gameState.enemy.health <= 0) {
                    setTimeout(enemyDefeated, 1000);
                    return;
                }
            } else if (skill.heal) {
                // æ²»ç–—æŠ€èƒ½
                gameState.health = Math.min(gameState.maxHealth, gameState.health + skill.heal);
                addToLog(`ä½ ä½¿ç”¨äº†${skill.name}ï¼Œæ¢å¤äº†${skill.heal}ç‚¹ç”Ÿå‘½å€¼ã€‚`, "heal");
                updateStats();
            }
            
            updateEnemyInfo();
            updateSkillCooldown();
            
            setTimeout(enemyAttack, 1200);
        }
        
        // é€ƒè·‘
        function flee() {
            if (!gameState.inCombat || gameState.actionInProgress) return;
            
            disableCombatButtons();
            
            // 70%çš„å‡ ç‡é€ƒè·‘æˆåŠŸ
            if (Math.random() < 0.7) {
                addToLog("ä½ æˆåŠŸé€ƒç¦»äº†æˆ˜æ–—ï¼", "event");
                gameState.inCombat = false;
                gameState.enemy = null;
                updateCombatUI();
                enableCombatButtons();
            } else {
                addToLog("é€ƒè·‘å¤±è´¥ï¼", "event");
                setTimeout(enemyAttack, 800);
            }
        }
        
        // ä¼‘æ¯æ¢å¤
        function rest() {
            if (gameState.inCombat) {
                addToLog("ä½ æ­£åœ¨æˆ˜æ–—ä¸­ï¼Œæ— æ³•ä¼‘æ¯ï¼", "event");
                return;
            }
            
            gameState.health = gameState.maxHealth;
            gameState.mana = gameState.maxMana;
            addToLog("ä½ ä¼‘æ¯äº†ä¸€ä¼šå„¿ï¼Œç”Ÿå‘½å€¼å’Œé­”æ³•å€¼å®Œå…¨æ¢å¤äº†ã€‚", "heal");
            updateStats();
        }
        
        // è®¿é—®å•†åº—
        function visitShop() {
            if (gameState.inCombat) {
                addToLog("ä½ æ­£åœ¨æˆ˜æ–—ä¸­ï¼Œæ— æ³•è®¿é—®å•†åº—ï¼", "event");
                return;
            }
            
            if (gameState.gold >= 30) {
                gameState.gold -= 30;
                gameState.potions++;
                addToLog("ä½ èŠ±è´¹30é‡‘å¸è´­ä¹°äº†ä¸€ç“¶ç”Ÿå‘½è¯æ°´ã€‚", "gold");
                updateStats();
                updateInventory();
                showNotification("è´­ä¹°ç”Ÿå‘½è¯æ°´ x1");
            } else {
                addToLog("é‡‘å¸ä¸è¶³ï¼Œæ— æ³•è´­ä¹°ç”Ÿå‘½è¯æ°´ï¼", "event");
            }
        }
        
        // å‡çº§è£…å¤‡
        function upgradeEquipment() {
            if (gameState.inCombat) {
                addToLog("ä½ æ­£åœ¨æˆ˜æ–—ä¸­ï¼Œæ— æ³•å‡çº§è£…å¤‡ï¼", "event");
                return;
            }
            
            if (gameState.gold >= 100) {
                gameState.gold -= 100;
                gameState.attack += 5;
                addToLog("ä½ èŠ±è´¹100é‡‘å¸å‡çº§äº†æ­¦å™¨ï¼Œæ”»å‡»åŠ›+5ï¼", "gold");
                updateStats();
                showNotification("æ”»å‡»åŠ› +5");
            } else {
                addToLog("å‡çº§æ­¦å™¨éœ€è¦100é‡‘å¸ï¼", "event");
            }
        }
        
        // ç§»åŠ¨åˆ°æ–°åŒºåŸŸ
        function moveTo(location) {
            if (gameState.inCombat) {
                addToLog("ä½ æ­£åœ¨æˆ˜æ–—ä¸­ï¼Œæ— æ³•ç§»åŠ¨ï¼", "event");
                return;
            }
            
            // å·¨é¾™å±±è„‰éœ€è¦é’¥åŒ™
            if (location === 'mountain' && gameState.keys < 1) {
                addToLog("ä½ éœ€è¦ç¥ç§˜é’¥åŒ™æ‰èƒ½è¿›å…¥å·¨é¾™å±±è„‰ï¼", "event");
                return;
            }
            
            gameState.location = location;
            locationEl.textContent = locationNames[location];
            addToLog(`ä½ æ¥åˆ°äº†${locationNames[location]}ã€‚`, "event");
            
            // ç‰¹æ®ŠåŒºåŸŸäº‹ä»¶
            if (location === 'cave') {
                addToLog("æ´ç©´ä¸­å¼¥æ¼«ç€ç¥ç§˜çš„æ°”æ¯ï¼Œæ·±å¤„ä¼¼ä¹éšè—ç€å®è—...", "event");
            } else if (location === 'mountain') {
                addToLog("å·¨é¾™å±±è„‰å¯’é£å‡›å†½ï¼Œè¿œå¤„ä¼ æ¥å·¨é¾™çš„å’†å“®å£°...", "event");
            }
        }
        
        // æ¸¸æˆç»“æŸ
        function gameOver() {
            addToLog("ä½ è¢«å‡»è´¥äº†...æ¸¸æˆç»“æŸï¼", "event");
            addToLog("æŒ‰F5åˆ·æ–°é¡µé¢é‡æ–°å¼€å§‹æ¸¸æˆã€‚");
            gameState.inCombat = false;
            updateCombatUI();
            enableCombatButtons();
        }
        
        // ä¿å­˜æ¸¸æˆ
        function saveGame() {
            localStorage.setItem('textRPG_save', JSON.stringify(gameState));
            addToLog("æ¸¸æˆè¿›åº¦å·²ä¿å­˜ï¼", "event");
            showNotification("æ¸¸æˆè¿›åº¦å·²ä¿å­˜");
        }
        
        // åŠ è½½æ¸¸æˆ
        function loadGame() {
            const saveData = localStorage.getItem('textRPG_save');
            if (saveData) {
                try {
                    const savedState = JSON.parse(saveData);
                    Object.assign(gameState, savedState);
                    updateStats();
                    locationEl.textContent = locationNames[gameState.location];
                    updateInventory();
                    updateCombatUI();
                    addToLog("æ¸¸æˆè¿›åº¦å·²åŠ è½½ï¼", "event");
                } catch (e) {
                    addToLog("åŠ è½½å­˜æ¡£å¤±è´¥ï¼", "event");
                }
            } else {
                addToLog("æ²¡æœ‰æ‰¾åˆ°å­˜æ¡£ï¼", "event");
            }
        }
        
        // äº‹ä»¶ç›‘å¬
        document.getElementById('exploreBtn').addEventListener('click', explore);
        document.getElementById('restBtn').addEventListener('click', rest);
        document.getElementById('shopBtn').addEventListener('click', visitShop);
        document.getElementById('upgradeBtn').addEventListener('click', upgradeEquipment);
        document.getElementById('forestBtn').addEventListener('click', () => moveTo('forest'));
        document.getElementById('caveBtn').addEventListener('click', () => moveTo('cave'));
        document.getElementById('mountainBtn').addEventListener('click', () => moveTo('mountain'));
        document.getElementById('attackBtn').addEventListener('click', playerAttack);
        document.getElementById('skillBtn').addEventListener('click', useSkill);
        document.getElementById('potionBtn').addEventListener('click', usePotion);
        document.getElementById('fleeBtn').addEventListener('click', flee);
        document.getElementById('saveBtn').addEventListener('click', saveGame);
        document.getElementById('loadBtn').addEventListener('click', loadGame);
        
        // ç‰©å“ç‚¹å‡»äº‹ä»¶
        document.getElementById('health-potion').addEventListener('click', usePotion);
        
        // æ¯å›åˆå‡å°‘æŠ€èƒ½å†·å´
        setInterval(reduceSkillCooldown, 3000);
        
        // åˆå§‹åŒ–æ¸¸æˆ
        initGame();
    </script>
</body>
</html>